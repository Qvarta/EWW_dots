#!/bin/bash

window_status(){

  window_list=("control" "screenshot" "chg_bg" "calendar" "net_list" "launcher" "desktop") 
  
  declare -A results

  for item in "${window_list[@]}"; do
    state=$(eww windows | grep "$item" | cut -c1)
    
    if [[ "$state" == "*" ]]; then
      results["$item"]="close"
    else
      results["$item"]="open"
    fi
  done

  json="{"
  for key in "${!results[@]}"; do
    json+="\"$key\":\"${results[$key]}\", "
  done
  json="${json%, *} }"
  echo "$json" | jq -r .
}
toggle_window(){
  local status="$(eww get windows_status | jq ".$1" | sed 's/"//g')"
  echo $(eww $status $1)
}

case "$1" in
  "status")
    window_status
    ;;
  "toggle")
    toggle_window desktop
    ;;
esac